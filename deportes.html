<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Año Deportivo CIC</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="deportes.css">
  <style>
    /* --- PALETA MINIMALISTA --- */
    :root {
      --primary-color: #1e293b;
      --secondary-color: #3b82f6;
      --accent-color: #64748b;
      --bg-dark: #111827;
      --text-color: #f1f5f9;
      --header-gradient: linear-gradient(90deg, #111827 60%, #3b82f6 100%);
      --highlight-blue: #2563eb;
      --blue-glass: rgba(59, 130, 246, 0.10);
      --border-radius: 14px;
      --shadow-min: 0 2px 8px #0002;
    }
    body {
      font-family: 'Roboto', 'Montserrat', 'Poppins', sans-serif;
      background: var(--bg-dark);
      color: var(--text-color);
      min-height: 100vh;
      margin: 0;
    }
    /* --- NAVBAR Y HERO --- */
    .navbar-custom {
      background: #101820;
      padding: 0.5rem 0;
      box-shadow: var(--shadow-min);
      border-bottom: 1.5px solid #222e3a;
    }
    .navbar-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
    }
    .navbar-logo .logo-img {
      height: 48px;
      width: 48px;
      border-radius: 50%;
      background: #fff;
      box-shadow: var(--shadow-min);
      border: 2px solid #e5e7eb;
      transition: box-shadow 0.2s, border 0.2s;
    }
    .navbar-menu {
      list-style: none;
      display: flex;
      gap: 1.5rem;
      margin: 0;
      padding: 0;
    }
    .navbar-menu li a {
      color: #fff;
      background: var(--secondary-color);
      padding: 0.5em 1.2em;
      border-radius: var(--border-radius);
      font-weight: 500;
      text-decoration: none;
      font-size: 1.08em;
      box-shadow: none;
      border: 2px solid transparent;
      transition: background 0.2s, color 0.2s, border 0.2s;
    }
    .navbar-menu li a.active, .navbar-menu li a:hover {
      background: #2563eb;
      color: #fff;
      border: 2px solid #2563eb;
    }
    .header-hero {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #101820;
      padding: 2.5rem 2rem 2rem 2rem;
      border-radius: 0 0 32px 32px;
      box-shadow: var(--shadow-min);
      min-height: 340px;
      margin-bottom: 2rem;
      position: relative;
      overflow: hidden;
    }
    .hero-content {
      flex: 1 1 60%;
      color: #fff;
      padding-right: 2rem;
    }
    .hero-title {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      letter-spacing: 1px;
    }
    .highlight-green {
      color: var(--secondary-color);
      font-weight: 900;
      letter-spacing: 2px;
    }
    .hero-desc {
      font-size: 1.1rem;
      color: #b0b8c1;
      margin-bottom: 1.5rem;
      max-width: 500px;
    }
    .hero-buttons {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.2rem;
    }
    .btn-green, .btn-outline {
      background: var(--secondary-color);
      color: #fff;
      border: none;
      border-radius: var(--border-radius);
      padding: 0.7em 2.2em;
      font-size: 1.08em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: none;
      transition: background 0.2s, color 0.2s, border 0.2s;
      border: 2px solid transparent;
    }
    .btn-green:hover, .btn-outline:hover {
      background: #2563eb;
      color: #fff;
      border: 2px solid #2563eb;
    }
    .btn-outline {
      background: transparent;
      color: var(--secondary-color);
      border: 2px solid var(--secondary-color);
      font-weight: 600;
    }
    .btn-outline:hover {
      background: #2563eb;
      color: #fff;
      border: 2px solid #2563eb;
    }
    .hero-info {
      color: var(--secondary-color);
      font-size: 1.05em;
      margin-top: 0.5rem;
    }
    .hero-img-container {
      flex: 1 1 40%;
      display: flex;
      align-items: center;
      justify-content: flex-end;
    }
    .hero-img {
      max-width: 340px;
      border-radius: 24px;
      box-shadow: 0 4px 32px #0006;
      border: 4px solid #1ed760;
      background: #fff;
    }
    @media (max-width: 900px) {
      .header-hero { flex-direction: column; padding: 2rem 1rem; }
      .hero-content { padding-right: 0; text-align: center; }
      .hero-img-container { justify-content: center; margin-top: 1.5rem; }
    }
    /* --- FIN NAVBAR Y HERO --- */
    .section-title {
      color: var(--secondary-color);
      font-weight: bold;
      margin-bottom: 30px;
      text-align: center;
      text-shadow: none;
    }
    .carousel-deportes {
      width: 100vw;
      max-width: 100vw;
      overflow: hidden;
      margin-bottom: 2rem;
      position: relative;
      box-shadow: 0 2px 12px #0006;
    }
    .carousel-img-deportes {
      width: 100vw;
      height: 350px;
      object-fit: cover;
      filter: brightness(0.85);
    }
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: #222e3a;
      color: var(--secondary-color);
      border: 2px solid var(--secondary-color);
      font-size: 2rem;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      z-index: 2;
      cursor: pointer;
      box-shadow: 0 2px 8px #0003;
      transition: background 0.2s, color 0.2s;
    }
    .carousel-btn:hover {
      background: var(--secondary-color);
      color: #fff;
    }
    .tab-section {
      margin-top: 2rem;
    }
    .nav-tabs .nav-link.active {
      background-color: var(--secondary-color);
      color: #fff;
      box-shadow: 0 2px 8px #0002;
    }
    .nav-tabs .nav-link {
      color: var(--secondary-color);
      font-weight: bold;
      background: #222e3a;
      border: none;
      margin-right: 2px;
      text-shadow: none;
    }
    .team-list {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
    }
    .team-card {
      background: #1e293b;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-min);
      padding: 1.2rem 1.7rem;
      min-width: 220px;
      text-align: center;
      transition: transform 0.18s, box-shadow 0.18s, border 0.18s;
      cursor: pointer;
      color: var(--secondary-color);
      border: 2px solid #222e3a;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    .team-card:hover {
      transform: translateY(-4px) scale(1.03);
      box-shadow: 0 4px 16px #3b82f6aa;
      background: #111827;
      color: var(--secondary-color);
      border: 2px solid #3b82f6;
    }
    .team-logo {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 50%;
      margin-bottom: 10px;
      border: 2px solid #e5e7eb;
      box-shadow: var(--shadow-min);
      background: #fff;
      transition: box-shadow 0.2s, border 0.2s;
    }
    .team-card:hover .team-logo {
      border: 2px solid #3b82f6;
      box-shadow: 0 2px 8px #3b82f6;
    }
    /* --- ESTILOS TABLA DE POSICIONES AZUL GLASS --- */
    .tabla-posiciones-float {
      background: rgba(17, 24, 39, 0.96);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-min);
      padding: 2.2rem 1.5rem 1.5rem 1.5rem;
      min-width: 480px;
      max-width: 900px;
      width: 99vw;
      margin: 0 auto;
      position: relative;
      z-index: 10;
      border: 1.5px solid #3b82f6;
      backdrop-filter: blur(6px) saturate(120%);
      transition: box-shadow 0.2s, border 0.2s;
    }
    .tabla-header-neon {
      background: #3b82f6;
      color: #fff;
      font-size: 1.05rem;
      border-radius: var(--border-radius) var(--border-radius) 0 0;
      border-bottom: 2px solid #2563eb;
      text-align: center;
      letter-spacing: 1px;
      text-shadow: none;
      box-shadow: none;
    }
    .tabla-row-neon {
      background: #2563eb;
      color: #fff;
      font-weight: 500;
      border-bottom: 1px solid #2563eb44;
      text-align: center;
      transition: background 0.18s, color 0.18s;
    }
    .tabla-row-neon:hover {
      background: #3b82f6;
      color: #fff;
    }
    .tabla-row-neon .pos-col {
      background: none;
      color: #fff;
      font-weight: bold;
      border-radius: 0;
      text-align: right;
      font-size: 1.1em;
      padding: 0 0.7em 0 0.7em;
      min-width: 38px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      margin-right: 0.2em;
      box-shadow: none;
      position: static;
      left: 0;
      z-index: 1;
    }
    .team-cell {
      display: flex;
      align-items: center;
      gap: 0.7em;
      min-width: 260px;
      max-width: 600px;
      width: 100%;
      text-align: left;
      background: #2563eb; /* Fondo azul más intenso */
      border-radius: 16px;
      padding: 0.4em 1.2em 0.4em 1.2em;
      box-shadow: 0 4px 24px #3b82f633, 0 2px 8px #0002;
      border: 1.5px solid #3b82f6aa;
      position: relative;
      z-index: 1;
      color: #fff;
      font-size: 1em;
    }
    .team-logo-tabla {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      object-fit: cover;
      border: 2.5px solid #fff;
      background: #3b82f6;
      margin-right: 0.3em;
      box-shadow: 0 2px 8px #0002;
    }
    .team-abbr {
      font-size: 1.05em;
      color: #fff;
      font-weight: 700;
      margin-left: 0.5em;
      letter-spacing: 1px;
    }
    .table-posiciones th, .table-posiciones td {
      border: none;
      padding: 0.3em 0.3em;
      font-size: 1.05em;
      vertical-align: middle;
    }
    .table-posiciones td {
      font-size: 0.95em;
    }
    .table-posiciones tr:last-child td {
      border-bottom: none;
    }
    @media (max-width: 700px) {
      .tabla-posiciones-float { padding: 1.2rem 0.2rem; min-width: 0; max-width: 99vw; }
      .team-cell { min-width: 120px; max-width: 99vw; padding: 0.3em 0.5em; }
    }
    /* --- FIN AJUSTES VISUALES TABLA DE POSICIONES --- */
    /* --- FIN ESTILOS --- */
  </style>
</head>
<body>
      <nav class="navbar-custom">
        <div class="navbar-container">
          <div class="navbar-logo">
            <img src="imagenes/logoplat-removebg-preview.png" alt="Logo Synapse CIC" class="logo-img">
          </div>
          <ul class="navbar-menu">
            <li><a href="index.html" class="active">Inicio</a></li>
            <li><a href="#deporteTabs">Equipos</a></li>
            <li><a href="#tablaPosicionesNueva">Tabla de Posiciones</a></li>
            <li><a href="futbol_femenino.html">Fútbol y Voley Femenino</a></li>
          </ul>
        </div>
      </nav>
      <header class="header-hero">
        <div class="hero-content">
          <h2 class="hero-title">AÑO DEPORTIVO <span class="highlight-green">CIC</span></h2>
          <p class="hero-desc">Descubre los equipos, posiciones, goleadores y toda la emoción del deporte escolar. Fútbol y voley, masculino y femenino, ¡todo en un solo lugar!</p>
          <div class="hero-buttons">
            <a href="#deporteTabs" class="btn-green">Equipos</a>
            <a href="#tablaPosicionesNueva" class="btn-outline">Tabla de Posiciones</a>
          </div>
          <div class="hero-info">
            <span class="location">Colegio Inglés Católico</span><br>
            <span class="time">Actualizado: <span id="fechaActual"></span></span>
          </div>
        </div>
        <div class="hero-img-container">
          <img src="imagenes/futsal/1.jpg" alt="Futsal Hero" class="hero-img">
        </div>
      </header>
      <script>
        document.getElementById('fechaActual').textContent = new Date().toLocaleDateString('es-ES');
      </script>

  <!-- Carrusel de imágenes del año deportivo -->
  <div class="carousel-deportes" id="carouselDeportes">
    <button class="carousel-btn prev" id="prevDeporte">&#10094;</button>
    <div class="carousel-track-deportes" id="carouselTrackDeportes">
      <img src="imagenes/futsal/1.jpg" class="carousel-img-deportes" alt="Futsal 1">
      <img src="imagenes/futsal/2.jpg" class="carousel-img-deportes" alt="Futsal 2">
      <img src="imagenes/futsal/3.jpg" class="carousel-img-deportes" alt="Futsal 3">
      <img src="imagenes/futsal/4.jpg" class="carousel-img-deportes" alt="Futsal 4">
      <img src="imagenes/futsal/5.jpg" class="carousel-img-deportes" alt="Futsal 5">
      <img src="imagenes/futsal/6.jpg" class="carousel-img-deportes" alt="Futsal 6">
    </div>
    <button class="carousel-btn next" id="nextDeporte">&#10095;</button>
  </div>

  <!-- Tabla de goleadores en vivo -->
    <div class="goleadores-list mb-4">
      <div class="tabla-posiciones-float" style="max-width:480px;margin:0 auto 2rem auto;">
        <h3 class="section-title" style="margin-bottom:32px;">Tabla de Goleadores (Fútbol)</h3>
        <table class="table table-posiciones" id="tablaGoleadores" style="min-width:0;width:100%;max-width:480px;margin:0 auto;background:transparent;box-shadow:none;border:none;">
          <thead>
            <tr class="tabla-header-neon">
              <th>#</th>
              <th>Jugador</th>
              <th>Equipo</th>
              <th>Goles</th>
            </tr>
          </thead>
          <tbody id="tbodyGoleadores">
            <!-- Filas generadas por JS -->
          </tbody>
        </table>
      </div>
    </div>

  <!-- Tabs Masculino/Femenino -->
  <ul class="nav nav-tabs" id="deporteTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="masculino-tab" type="button" role="tab">Masculino</button>
    </li>
  </ul>
  <div class="tab-content tab-section" id="deporteTabsContent">
    <!-- Masculino -->
    <div class="tab-pane" id="masculino" role="tabpanel" style="display:block;">
      <h3 class="section-title">Fútbol Masculino</h3>
      <div class="team-list" id="teamListMasculino">
        <!-- Equipos masculinos se cargan dinámicamente -->
      </div>
      <div id="plantillaMasculino">
        <!-- Plantilla de jugadores se carga dinámicamente -->
      </div>
    </div>
  </div>
  <script>
    
    const track = document.getElementById('carouselTrackDeportes');
    const images = track.querySelectorAll('.carousel-img-deportes');
    let currentIndex = 0;
    function updateCarousel() {
      track.style.transform = `translateX(-${currentIndex * 100}vw)`;
    }
    document.getElementById('prevDeporte').onclick = () => {
      currentIndex = (currentIndex === 0) ? images.length - 1 : currentIndex - 1;
      updateCarousel();
    };
    document.getElementById('nextDeporte').onclick = () => {
      currentIndex = (currentIndex === images.length - 1) ? 0 : currentIndex + 1;
      updateCarousel();
    };

    
    
    const cursosMasculino = [
      '1A','1B','1C','2A','2B','2C','3A','3B','3C','4A','4B','4C','5A','5B','5C','6A','6B','6C'
    ];
    const equiposMasculino = cursosMasculino.map((curso, i) => ({
      curso,
      nombre: `Equipo M ${curso}`,
  logo: 'imagenes/logoplat-removebg-preview.png',
      jugadores: generarJugadoresAleatoriosUnicos(curso, 7)
    }));

    
    function generarJugadoresAleatoriosUnicos(curso, cantidad) {
      const nombresBase = [
        'Lucas', 'Mateo', 'Santiago', 'Tomás', 'Benjamín', 'Joaquín', 'Martín', 'Emilio', 'Franco', 'Agustín',
        'Nicolás', 'Facundo', 'Juan', 'Simón', 'Iván', 'Bruno', 'Thiago', 'Dylan', 'Samuel', 'Axel',
        'Gabriel', 'Leonardo', 'Matías', 'Valentín', 'Lautaro', 'Andrés', 'Felipe', 'Alan', 'Elías', 'Bautista'
      ];
      const apodosBase = [
        'El Rayo', 'El Mago', 'El Tanque', 'El Pulga', 'El Toro', 'El Gato', 'El Pibe', 'El Vikingo', 'El Lince', 'El Crack',
        'El Profe', 'El Motor', 'El Kaiser', 'El Chino', 'El Dibu', 'El Loco', 'El Zurdo', 'El Capi', 'El Ninja', 'El León',
        'El Muro', 'El Fantasma', 'El Rifle', 'El Duende', 'El Titán', 'El Pistolero', 'El Maestro', 'El Místico', 'El Príncipe', 'El Genio'
      ];
      
      const nombres = [...nombresBase].sort(() => Math.random() - 0.5).slice(0, cantidad);
      const apodos = [...apodosBase].sort(() => Math.random() - 0.5).slice(0, cantidad);
      return Array.from({length: cantidad}, (_, j) => ({
        nombre: nombres[j],
        apodo: apodos[j]
      }));
    }
    const posicionesMasculino = cursosMasculino.map((curso, i) => ({
      curso,
      nombre: `Equipo M ${curso}`,
      pts: Math.floor(Math.random()*20),
      pj: Math.floor(Math.random()*10)+1,
      pg: Math.floor(Math.random()*10),
      pe: Math.floor(Math.random()*5),
      pp: Math.floor(Math.random()*5),
      gf: Math.floor(Math.random()*30),
      gc: Math.floor(Math.random()*30)
    }));
    
    function renderEquiposMasculino() {
      const teamList = document.getElementById('teamListMasculino');
      teamList.innerHTML = '';
      equiposMasculino.forEach(eq => {
        const div = document.createElement('div');
        div.className = 'team-card';
        div.innerHTML = `<img src="${eq.logo}" class="team-logo"><h5>${eq.nombre}</h5><p>${eq.curso}</p>`;
        div.onclick = () => renderPlantilla(eq, 'plantillaMasculino');
        teamList.appendChild(div);
      });
    }
    
    function renderPlantilla(equipo, contenedorId) {
      const cont = document.getElementById(contenedorId);
      if (!equipo || !equipo.jugadores) {
        cont.innerHTML = '<div class="alert alert-warning">No hay plantilla disponible.</div>';
        return;
      }
      let html = `<div class="tabla-posiciones-float" style="margin-top:1.5rem;">
        <h5 style="color:var(--secondary-color);text-align:center;margin-bottom:1rem;">Plantilla de <b>${equipo.nombre}</b></h5>
        <table class="table table-posiciones" style="width:100%;margin:0 auto;">
          <thead>
            <tr class="tabla-header-neon">
              <th>#</th>
              <th>Nombre</th>
              <th>Apodo</th>
            </tr>
          </thead>
          <tbody>`;
      equipo.jugadores.forEach((jug, idx) => {
        html += `<tr class="tabla-row-neon">
          <td>${idx+1}</td>
          <td>${jug.nombre}</td>
          <td>${jug.apodo}</td>
        </tr>`;
      });
      html += `</tbody></table></div>`;
      cont.innerHTML = html;
    }
    
    document.getElementById('masculino-tab').onclick = function() {
      document.getElementById('masculino').style.display = '';
      this.classList.add('active');
      renderEquiposMasculino();
      document.getElementById('plantillaMasculino').innerHTML = '';
    };
    
    renderEquiposMasculino();
    renderGoleadores();

    
    function generarGoleadores() {
      
      let lista = [];
      equiposMasculino.forEach(eq => {
        eq.jugadores.forEach(jug => {
          
          const goles = Math.random() < 0.5 ? Math.floor(Math.random()*8)+1 : 0;
          if (goles > 0) {
            lista.push({
              nombre: jug.nombre,
              apodo: jug.apodo,
              equipo: eq.nombre,
              goles
            });
          }
        });
      });
      
      lista.sort((a, b) => b.goles - a.goles);
      
      return lista.slice(0, 10);
    }

    function renderGoleadores() {
      const tbody = document.getElementById('tbodyGoleadores');
      if (!tbody) return;
      const goleadores = generarGoleadores();
      tbody.innerHTML = '';
      goleadores.forEach((g, idx) => {
        tbody.innerHTML += `
          <tr class="tabla-row-neon">
            <td>${idx+1}</td>
            <td>${g.nombre} <span style="color:#60a5fa;font-size:0.95em;">(${g.apodo})</span></td>
            <td>${g.equipo}</td>
            <td><b>${g.goles}</b></td>
          </tr>
        `;
      });
    }
  </script>

  <!-- Nueva tabla de posiciones desde cero -->
  <section class="tabla-posiciones-wrapper" style="margin-top:3rem;">
        <div class="tabla-posiciones-float">
      <table class="table table-posiciones" id="tablaPosicionesNueva" style="min-width:700px;width:100%;max-width:1100px;margin:0 auto;">
            <thead>
              <tr class="tabla-header-neon">
                <th>POS</th>
                <th>EQUIPO</th>
                <th>PJ</th>
                <th>PG</th>
                <th>PE</th>
                <th>PP</th>
                <th>GF</th>
                <th>GC</th>
                <th>DG</th>
                <th>PTS</th>
              </tr>
            </thead>
            <tbody id="tbodyPosicionesNueva">
              <!-- Filas generadas por JS -->
            </tbody>
          </table>
        </div>
      </section>
      <script>
        
        // Standings now driven by admin panel via localStorage keys:
        // teams -> 'sports_teams_v1'
        // players -> 'sports_players_v1'
        // matches -> 'sports_matches_v1'
        // manual stats (optional overrides) -> 'sports_manual_stats_v1'

        const TEAMS_KEY = 'sports_teams_v1';
        const PLAYERS_KEY = 'sports_players_v1';
        const MATCHES_KEY = 'sports_matches_v1';
        const MANUAL_KEY = 'sports_manual_stats_v1';

        // initial teams and sample stats (from the table the user provided)
        const initialTeams = [
          'Always Ready 6A',
          'Aurora 1A',
          'Blooming 1B',
          'Bolívar 1C',
          'Destroyers 2A',
          'GV San José 2B',
          'Guabirá 2C',
          'Independiente Petrolero 3A',
          'Jorge Wilstermann 3B',
          'Nacional Potosí 3C',
          'Oruro Royal 4A',
          'Oriente Petrolero 4B',
          'Real Potosí 4C',
          'Real Santa Cruz 5A',
          'Real Tomayapo 5B',
          'San Antonio Bulo Bulo 5C',
          'San José 6B',
          'The Strongest 6C'
        ];

        const initialManual = {
          1: {pj:14, pg:9, pe:2, pp:3, gf:8, gc:2, pts:29},
          2: {pj:5, pg:3, pe:1, pp:1, gf:9, gc:5, pts:10},
          3: {pj:7, pg:2, pe:4, pp:1, gf:11, gc:19, pts:10},
          4: {pj:9, pg:6, pe:1, pp:2, gf:11, gc:22, pts:19},
          5: {pj:13, pg:6, pe:0, pp:7, gf:22, gc:14, pts:18},
          6: {pj:11, pg:8, pe:2, pp:1, gf:28, gc:29, pts:26},
          7: {pj:11, pg:4, pe:1, pp:6, gf:5, gc:8, pts:13},
          8: {pj:6, pg:5, pe:0, pp:1, gf:23, gc:26, pts:15},
          9: {pj:13, pg:0, pe:9, pp:4, gf:3, gc:3, pts:9},
          10: {pj:8, pg:4, pe:0, pp:4, gf:26, gc:6, pts:12},
          11: {pj:7, pg:0, pe:6, pp:1, gf:16, gc:24, pts:6},
          12: {pj:10, pg:3, pe:3, pp:4, gf:6, gc:20, pts:12},
          13: {pj:14, pg:12, pe:1, pp:1, gf:24, gc:3, pts:37},
          14: {pj:10, pg:9, pe:0, pp:1, gf:6, gc:17, pts:27},
          15: {pj:10, pg:1, pe:4, pp:5, gf:13, gc:5, pts:7},
          16: {pj:12, pg:11, pe:0, pp:1, gf:17, gc:3, pts:33},
          17: {pj:12, pg:8, pe:2, pp:2, gf:22, gc:2, pts:26},
          18: {pj:9, pg:8, pe:0, pp:1, gf:29, gc:10, pts:24}
        };

        function ensureInitial(){
          if(!localStorage.getItem(TEAMS_KEY)){
            const teams = initialTeams.map((name,i)=>({ id: i+1, name }));
            localStorage.setItem(TEAMS_KEY, JSON.stringify(teams));
          }
          if(!localStorage.getItem(MANUAL_KEY)){
            localStorage.setItem(MANUAL_KEY, JSON.stringify(initialManual));
          }
        }

        function getTeams(){ return JSON.parse(localStorage.getItem(TEAMS_KEY) || '[]'); }
        function getMatches(){ return JSON.parse(localStorage.getItem(MATCHES_KEY) || '[]'); }
        function getManual(){ return JSON.parse(localStorage.getItem(MANUAL_KEY) || '{}'); }

        function saveTeams(teams){ localStorage.setItem(TEAMS_KEY, JSON.stringify(teams)); }
        function saveManual(man){ localStorage.setItem(MANUAL_KEY, JSON.stringify(man)); }

        // compute stats from matches
        function computeFromMatches(){
          const teams = getTeams();
          const matches = getMatches();
          const stats = {};
          teams.forEach(t=> stats[t.id] = { pj:0, pg:0, pe:0, pp:0, gf:0, gc:0, pts:0 });
          matches.forEach(m=>{
            const h = String(m.homeId), a = String(m.awayId);
            if(!stats[h] || !stats[a]) return;
            const hs = Number(m.homeScore), as = Number(m.awayScore);
            stats[h].pj++; stats[a].pj++;
            stats[h].gf += hs; stats[h].gc += as;
            stats[a].gf += as; stats[a].gc += hs;
            if(hs>as){ stats[h].pg++; stats[h].pts +=3; stats[a].pp++; }
            else if(hs<as){ stats[a].pg++; stats[a].pts +=3; stats[h].pp++; }
            else { stats[h].pe++; stats[a].pe++; stats[h].pts+=1; stats[a].pts+=1; }
          });
          return stats;
        }

        // small helper to escape HTML when rendering read-only values
        function escapeHtml(str){
          return String(str === undefined || str === null ? '' : str).replace(/[&<>"']/g, function(c){
            return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"})[c];
          });
        }

        function buildTable(){
          ensureInitial();
          const teams = getTeams();
          const matches = getMatches();
          const manual = getManual();
          // if matches exist, compute from matches; else use manual stats
          const computed = (matches && matches.length)? computeFromMatches() : {};
          // merge manual and computed: computed takes precedence; manual fills missing
          const rows = teams.map(t=>{
            const id = t.id;
            const base = computed && computed[id] ? computed[id] : (manual[id] || {pj:0,pg:0,pe:0,pp:0,gf:0,gc:0,pts:0});
            return {
              id,
              name: t.name,
              pj: base.pj || 0,
              pg: base.pg || 0,
              pe: base.pe || 0,
              pp: base.pp || 0,
              gf: base.gf || 0,
              gc: base.gc || 0,
              pts: base.pts || 0
            };
          });
          // calculate dg
          rows.forEach(r=> r.dg = r.gf - r.gc);
          // allow either admin.html or admins.html (some files use plural)
          const editMode = /admin(s)?\.html$/.test(window.location.pathname);
          // sort by pts desc, dg desc, gf desc
          rows.sort((a,b)=> (b.pts - a.pts) || (b.dg - a.dg) || (b.gf - a.gf) || a.name.localeCompare(b.name));

          const tbody = document.getElementById('tbodyPosicionesNueva'); tbody.innerHTML = '';
          rows.forEach((r, idx)=>{
            const tr = document.createElement('tr'); tr.className='tabla-row-neon';
            if(editMode){
              tr.innerHTML = `
                <td>${idx+1}</td>
                <td><input data-id="${r.id}" class="form-control form-control-sm team-name-input" value="${r.name}" /></td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="pj" type="number" value="${r.pj}" /></td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="pg" type="number" value="${r.pg}" /></td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="pe" type="number" value="${r.pe}" /></td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="pp" type="number" value="${r.pp}" /></td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="gf" type="number" value="${r.gf}" /></td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="gc" type="number" value="${r.gc}" /></td>
                <td class="dg-col">${r.dg>0?`+${r.dg}`:r.dg}</td>
                <td><input data-id="${r.id}" class="form-control form-control-sm stat-input" data-field="pts" type="number" value="${r.pts}" /></td>
              `;
            } else {
              // public view: render read-only cells (no inputs)
              tr.innerHTML = `
                <td>${idx+1}</td>
                <td style="text-align:left;padding-left:0.9em;">${escapeHtml(r.name||'')}</td>
                <td>${r.pj}</td>
                <td>${r.pg}</td>
                <td>${r.pe}</td>
                <td>${r.pp}</td>
                <td>${r.gf}</td>
                <td>${r.gc}</td>
                <td class="dg-col">${r.dg>0?`+${r.dg}`:r.dg}</td>
                <td>${r.pts}</td>
              `;
            }
            tbody.appendChild(tr);
          });

          // attach handlers only in editMode
          if(editMode){
            document.querySelectorAll('.team-name-input').forEach(inp=>{
              inp.addEventListener('change', (e)=>{
                const id = Number(e.target.dataset.id); const teams = getTeams(); const t = teams.find(x=>x.id===id); if(t){ t.name = e.target.value; saveTeams(teams); }
              });
            });
            document.querySelectorAll('.stat-input').forEach(inp=>{
              inp.addEventListener('change', (e)=>{
                const id = Number(e.target.dataset.id); const field = e.target.dataset.field; const val = Number(e.target.value)||0;
                const manual = getManual(); if(!manual[id]) manual[id] = {};
                manual[id][field] = val; // update manual override
                // if modifying pg/pe/pp/pj/gf/gc maybe recompute pts/dg later
                if(field==='pg' || field==='pe'){
                  manual[id].pts = (manual[id].pg||0)*3 + (manual[id].pe||0)*1;
                }
                saveManual(manual);
                buildTable();
              });
            });
          }
        }

        // Recalculate from matches and save to manual
        function recalcFromMatchesAndSave(){
          const computed = computeFromMatches();
          saveManual(computed);
          buildTable();
        }

        document.addEventListener('DOMContentLoaded', ()=>{
          ensureInitial();
          // add recalc button
          const wrapper = document.querySelector('.tabla-posiciones-float');
          const editMode = /admin(s)?\.html$/.test(window.location.pathname);
          const btn = document.createElement('button'); btn.className='btn btn-sm btn-outline-light'; btn.style.margin='8px'; btn.textContent='Recalcular desde partidos';
          btn.onclick = recalcFromMatchesAndSave; wrapper.insertBefore(btn, wrapper.firstChild);
          const refresh = document.createElement('button'); refresh.className='btn btn-sm btn-outline-light'; refresh.style.margin='8px'; refresh.textContent='Refrescar'; refresh.onclick = buildTable; wrapper.insertBefore(refresh, wrapper.firstChild);
          // add Vaciar tabla button only in admin mode
            if(editMode){
            const clearBtn = document.createElement('button'); clearBtn.className='btn btn-sm btn-danger'; clearBtn.style.margin='8px'; clearBtn.textContent='Vaciar tabla';
            clearBtn.onclick = ()=>{
              if(!confirm('¿Poner puntajes de equipos a 0? Esto reseteará los resultados y estadísticas guardadas localmente.')) return;
              try{
                // clear matches and manual overrides but keep teams
                localStorage.setItem(MATCHES_KEY, JSON.stringify([]));
                localStorage.setItem(MANUAL_KEY, JSON.stringify({}));
              }catch(e){ console.error('Error clearing storage:', e); }
              buildTable();
              alert('Puntajes reseteados a 0.');
            };
            wrapper.insertBefore(clearBtn, wrapper.firstChild);
          }
          buildTable();
        });

        // live update when admin tab changes localStorage
        window.addEventListener('storage', (e)=>{
          if([TEAMS_KEY, MATCHES_KEY, MANUAL_KEY].includes(e.key)) buildTable();
        });

      </script>
  <style>
    #tablaPosicionesNueva {
      width: 100%;
      min-width: 700px;
      max-width: 1100px;
      margin: 0 auto;
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: var(--shadow-min);
    }
    #tablaPosicionesNueva th, #tablaPosicionesNueva td {
      text-align: center;
      color: #fff;
      font-size: 1.08em;
      padding: 0.6em 0.5em;
      border-radius: 0;
      transition: background 0.18s, color 0.18s;
    }
    #tablaPosicionesNueva th {
      background: #3b82f6;
      color: #fff;
      font-weight: 700;
      border-bottom: 2px solid #2563eb;
      letter-spacing: 1px;
      text-shadow: none;
    }
    #tablaPosicionesNueva td {
      background: #2563eb;
      border-bottom: 1px solid #3b82f6;
    }
    #tablaPosicionesNueva tr:last-child td {
      border-bottom: none;
    }
    #tablaPosicionesNueva tr:hover td {
      background: #3b82f6;
      color: #fff;
    }
    @media (max-width: 900px) {
      #tablaPosicionesNueva, .tabla-posiciones-float { min-width: 0; max-width: 99vw; font-size: 0.95em; }
    }
      </style>
  <footer class="footer mt-auto">
    <div class="container text-center">
      <p>&copy; 2025 Colegio Inglés Católico. Todos los derechos reservados.</p>
    </div>
  </footer>
</body>
</html>
